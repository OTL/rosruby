task :default => :msg_local

message_dir = "#{ENV['HOME']}/.ros/rosruby"

desc "generate all messages in local dir"
task :msg_local => message_dir

require 'rake/clean'
CLEAN << 'doc'
CLEAN << message_dir

require 'rake/rdoctask'
Rake::RDocTask.new do |rdoc|
  rdoc.rdoc_dir = 'doc'
  rdoc.rdoc_files = FileList["lib/**/*.rb"]
  rdoc.main = "ROS::Node"
  rdoc.title = 'rosruby API'
end

desc "generate all messages in local dir."
file message_dir do |file|
  sh('scripts/gen_for_precompiled.py')
end

require 'rake/testtask'
Rake::TestTask.new do |t|
  t.test_files = FileList['test/test*.rb']
  t.verbose = true
end
task :test => [:msg_local]
